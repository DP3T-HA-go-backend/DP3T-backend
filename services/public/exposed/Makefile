URL=http://localhost:8080

exposed: main.go exposed.pb.go
	go build -o exposed

exposed.pb.go: exposed.proto
	PATH=$(PATH):$(HOME)/go/bin protoc --go_out=. exposed.proto

post:
	@echo "POST $(URL)/exposed"
	@curl -sS -X POST \
		--header "Content-Type: application/json" \
		--data '{"key":"SAMPLE_KEY","keyDate":1234}' \
		$(URL)/exposed

get:
	@echo "GET $(URL)/exposed/$$(date +"%s")"
	@curl -sS -X GET $(URL)/exposed/$$(date +"%s") | \
		protoc --decode main.ProtoExposedList exposed.proto

clean:
	rm -f exposed
	rm -f exposed.pb.go

.PHONY: post get clean
